from urllib.request import urlopen
import json
from pprint import pprint
from matplotlib import pyplot as plt

Library4='https://api.ami-lab.org/api/v1/cisco/zone/KR-CCELIB/building/CCELIB-Central%20Library/floor/CCELIB-CL-04/devices?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTYyNDIwMzIsImF1ZCI6Ik5VUyBEYXRhIEFQSSIsImlzcyI6IkFNSSBMYWIsIE5VUyIsInN1YiI6ImUwMTc4MTgzIiwiZXhwIjoxNTE2MzI4NDMyfQ.XvscyODiBCm6aRxMY3zAnw7TCJqus15UGhMCnpnlbR6U52icJTXiBXH9YjleF6rfGfKc17fAiYWW6QxsUznHlFE3gM4Rto0h8-r9106pDilXs-5vSK7A3898-UEApizvzshiuTMcmgnAPKT4CEnF_Cb-f-Udzpt9B98FLP3P26poItN0qaIuoTx3DfRcF5j-CTJSDptvvZCpi3kLj3_jQugszpTflCoWF5LVsAUxpLExjbF7ckmcOymq7ECircODpeLRCUn3Q0oKz2DWXDPTDf7iZofFlolNN_UoYPRoCMq94--p6xCxoTy3O44q1phVtH7OlWvQWDQ3AuPN9ZOdlg'
Library5='https://api.ami-lab.org/api/v1/cisco/zone/KR-CCELIB/building/CCELIB-Central%20Library/floor/CCELIB-CL-05/devices?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTY1ODM1NzMsImF1ZCI6Ik5VUyBEYXRhIEFQSSIsImlzcyI6IkFNSSBMYWIsIE5VUyIsInN1YiI6ImUwMTc4MTgzIiwiZXhwIjoxNTE2NjY5OTczfQ.kAEkC8zAHVNUSbc0NFJzOJKgqJ2kzyQNGRm0Li4wIams3HZ4BpOd_B3DUq91Fb7XstaEzFMFjtlKhoeXmt19IZSn0MxxdmpxPCSSZpER6ktRRVMVOXjFT3j6Tj6F_yOIN1XHc-wvbU_gElAqCCU4qY1NPDvKi80LZX-QYETFVOwUUtI57v5b_Zbi2cWVLVZrP6R2qG3kDLziaMEUXh-JtoEd93R12xbxqPydtTYEky6H2bqxgSXvq5PUgUQtKjbFiBnSvc0W6WeO6kA-xpU74lsINQLJ_6nqrB8dOFPqadmYX9TFR500rnvifoqfm9LMm-7jUgYwRQWZ7NEhvxLUyw'
I3='https://api.ami-lab.org/api/v1/cisco/zone/KR-FBALAW/building/FBALAW-I3/floor/FBALAW-I3-02/devices?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTYyNDIwMzIsImF1ZCI6Ik5VUyBEYXRhIEFQSSIsImlzcyI6IkFNSSBMYWIsIE5VUyIsInN1YiI6ImUwMTc4MTgzIiwiZXhwIjoxNTE2MzI4NDMyfQ.XvscyODiBCm6aRxMY3zAnw7TCJqus15UGhMCnpnlbR6U52icJTXiBXH9YjleF6rfGfKc17fAiYWW6QxsUznHlFE3gM4Rto0h8-r9106pDilXs-5vSK7A3898-UEApizvzshiuTMcmgnAPKT4CEnF_Cb-f-Udzpt9B98FLP3P26poItN0qaIuoTx3DfRcF5j-CTJSDptvvZCpi3kLj3_jQugszpTflCoWF5LVsAUxpLExjbF7ckmcOymq7ECircODpeLRCUn3Q0oKz2DWXDPTDf7iZofFlolNN_UoYPRoCMq94--p6xCxoTy3O44q1phVtH7OlWvQWDQ3AuPN9ZOdlg'
E1L6='https://api.ami-lab.org/api/v1/cisco/zone/KR-AKIENG/building/AKIENG-E1/floor/AKIENG-E1-06/devices?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTY2MTQ3MzQsImF1ZCI6Ik5VUyBEYXRhIEFQSSIsImlzcyI6IkFNSSBMYWIsIE5VUyIsInN1YiI6ImUwMTc4MTgzIiwiZXhwIjoxNTE2NzAxMTM0fQ.YDKZsoFWmJk44KBS-l3h6hDxgeTi_InWFUcejWY8FoH7Sy09IFLSG68uGUuE202eZBjylIwhva3H2r8ze5ODDXa2q2-rBzKUQfeecrsXsCVAaTLUpLZrC-0agMJ5KkYxiGizL6OumqY_0GPWJRGA0EISfl9reItdERM7_5h7F2QcRH8PTJj1T-cXx2h1-KVAiqojVxPB8pre352zqIrO3IoAWFmRDDgxb0Q5GQs58R0By-NktCxX2ntfpCQFMwWDhXEAB18fYDb9a388S93G8LgyPkF9Sj-1XWtphR77mSRbygRUafmyqP7eMazMU1ouhjMRqTSQyhiNpYQ6b5MTEA'
E1L7='https://api.ami-lab.org/api/v1/cisco/zone/KR-AKIENG/building/AKIENG-E1/floor/AKIENG-E1-07/devices?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTY2MjA2MzAsImF1ZCI6Ik5VUyBEYXRhIEFQSSIsImlzcyI6IkFNSSBMYWIsIE5VUyIsInN1YiI6ImUwMTc4MTgzIiwiZXhwIjoxNTE2NzA3MDMwfQ.hpX2YSrRbjlsEJGrBpZ7zT7d-JkJFVFfNdqzNLnjsDwKuG1RgH4Vrd6U4kdNkAks8GJLj-vSYLJDn2IwJJURnkV1Dc0SgG36dEwDPTZ64yvG33FdZb7fwLwkOR2wY04vJmg5msQ3NbQW8cJbq9IToCDc2XWlQHsetumPhWGQh1Jn-VfMjs2zE80SkaBAeed_p15uow5ZMad9XSpL7R_6GUAS--7MTupPZK9iRtkeHyymiT3Y6DIRhf4qiaawCkAsmdKvoMZekSHMB9QNSnFlK-x_WOV0ylMzuZUWWQyZw3OBDMPiZ_u4NUdjn3wjDOl5cdjeDap_iLG5A7oPmsSjnw'
E1L5='https://api.ami-lab.org/api/v1/cisco/zone/KR-AKIENG/building/AKIENG-E1/floor/AKIENG-E1-05/devices?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTY2MTQ3MzQsImF1ZCI6Ik5VUyBEYXRhIEFQSSIsImlzcyI6IkFNSSBMYWIsIE5VUyIsInN1YiI6ImUwMTc4MTgzIiwiZXhwIjoxNTE2NzAxMTM0fQ.YDKZsoFWmJk44KBS-l3h6hDxgeTi_InWFUcejWY8FoH7Sy09IFLSG68uGUuE202eZBjylIwhva3H2r8ze5ODDXa2q2-rBzKUQfeecrsXsCVAaTLUpLZrC-0agMJ5KkYxiGizL6OumqY_0GPWJRGA0EISfl9reItdERM7_5h7F2QcRH8PTJj1T-cXx2h1-KVAiqojVxPB8pre352zqIrO3IoAWFmRDDgxb0Q5GQs58R0By-NktCxX2ntfpCQFMwWDhXEAB18fYDb9a388S93G8LgyPkF9Sj-1XWtphR77mSRbygRUafmyqP7eMazMU1ouhjMRqTSQyhiNpYQ6b5MTEA'
E1A='https://api.ami-lab.org/api/v1/cisco/zone/KR-ENGADM/building/ENGADM-E1A/floor/ENGADM-E1A-06/devices?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTY2MjA2MzAsImF1ZCI6Ik5VUyBEYXRhIEFQSSIsImlzcyI6IkFNSSBMYWIsIE5VUyIsInN1YiI6ImUwMTc4MTgzIiwiZXhwIjoxNTE2NzA3MDMwfQ.hpX2YSrRbjlsEJGrBpZ7zT7d-JkJFVFfNdqzNLnjsDwKuG1RgH4Vrd6U4kdNkAks8GJLj-vSYLJDn2IwJJURnkV1Dc0SgG36dEwDPTZ64yvG33FdZb7fwLwkOR2wY04vJmg5msQ3NbQW8cJbq9IToCDc2XWlQHsetumPhWGQh1Jn-VfMjs2zE80SkaBAeed_p15uow5ZMad9XSpL7R_6GUAS--7MTupPZK9iRtkeHyymiT3Y6DIRhf4qiaawCkAsmdKvoMZekSHMB9QNSnFlK-x_WOV0ylMzuZUWWQyZw3OBDMPiZ_u4NUdjn3wjDOl5cdjeDap_iLG5A7oPmsSjnw'
E1A5='https://api.ami-lab.org/api/v1/cisco/zone/KR-ENGADM/building/ENGADM-E1A/floor/ENGADM-E1A-05/devices?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpYXQiOjE1MTY2MjA2MzAsImF1ZCI6Ik5VUyBEYXRhIEFQSSIsImlzcyI6IkFNSSBMYWIsIE5VUyIsInN1YiI6ImUwMTc4MTgzIiwiZXhwIjoxNTE2NzA3MDMwfQ.hpX2YSrRbjlsEJGrBpZ7zT7d-JkJFVFfNdqzNLnjsDwKuG1RgH4Vrd6U4kdNkAks8GJLj-vSYLJDn2IwJJURnkV1Dc0SgG36dEwDPTZ64yvG33FdZb7fwLwkOR2wY04vJmg5msQ3NbQW8cJbq9IToCDc2XWlQHsetumPhWGQh1Jn-VfMjs2zE80SkaBAeed_p15uow5ZMad9XSpL7R_6GUAS--7MTupPZK9iRtkeHyymiT3Y6DIRhf4qiaawCkAsmdKvoMZekSHMB9QNSnFlK-x_WOV0ylMzuZUWWQyZw3OBDMPiZ_u4NUdjn3wjDOl5cdjeDap_iLG5A7oPmsSjnw'
allurl=[Library4,Library5,I3]
'''
def online(url):
	u=urlopen(url)
	resp=json.loads(u.read().decode('utf-8'))
	time=resp[0]['Statistics']['currentServerTime'][11:-9]
	num=len(resp)
	return time,num
num=[]

for i in allurl:
	a,b=online(i)
	num.append(b)
x=range(len(allurl))
y=num
plt.bar(x,y)
lable=['L4','L5','I3']
i=0
for xx, yy in zip(x,y):
	plt.text(xx, yy+1, str(yy), ha='center')
	plt.text(xx, -30,lable[i],ha='center',color='green')
	i+=1
plt.show()
'''


u=urlopen(E1L6,timeout=10)
resp=json.loads(u.read().decode('utf-8')) #type=list[dict]
time=resp[0]['Statistics']['currentServerTime'][11:-9]
num=len(resp)
pprint(resp)


for i in resp:
	if 'ipAddress' in i:
		if i['ipAddress']==['172.17.17.117']:
			print('------------')
			print(i)
		
# my iphone mac='d33ec540eb6b725326b2e351ee9328aa7c1deecb' 1/18
# 'd33ec540eb6b725326b2e351ee9328aa7c1deecb' 1/19
# 'd33ec540eb6b725326b2e351ee9328aa7c1deecb' 1/22

